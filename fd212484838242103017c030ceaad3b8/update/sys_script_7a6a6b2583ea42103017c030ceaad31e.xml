<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_script">
    <sys_script action="INSERT_OR_UPDATE">
        <abort_action>false</abort_action>
        <access>package_private</access>
        <action_delete>false</action_delete>
        <action_insert>true</action_insert>
        <action_query>false</action_query>
        <action_update>true</action_update>
        <active>true</active>
        <add_message>false</add_message>
        <advanced>true</advanced>
        <change_fields>false</change_fields>
        <client_callable>false</client_callable>
        <collection>x_1143021_loaner_v_vehicle_tracker</collection>
        <condition/>
        <description/>
        <execute_function>false</execute_function>
        <filter_condition table="x_1143021_loaner_v_vehicle_tracker">vehicle_statusVALCHANGES^EQ<item display_value="-- None --" endquery="false" field="vehicle_status" goto="false" newquery="false" operator="VALCHANGES" or="false" value=""/>
            <item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/>
        </filter_condition>
        <is_rest>false</is_rest>
        <message/>
        <name>Vehicle Status-Auto Update to Available</name>
        <order>100</order>
        <priority>100</priority>
        <rest_method/>
        <rest_method_text/>
        <rest_service/>
        <rest_service_text/>
        <rest_variables/>
        <role_conditions/>
        <script><![CDATA[(function executeRule(current, previous /*null when async*/ ) {

    var vehStat = current.vehicle_status; // Get the ‘vehicle_status’ from the current vehicle status field

    var gr = new GlideRecord('x_1143021_loaner_v_loaner_vehicle_catalog'); // Create a variable for a new GlideRecord on the loaner vehicle catalog table

    gr.addQuery('sys_id', current.reference); // Query that table for the sys_id
    // of the current vehicle field

    gr.query(); // Execute the query.

    if (gr._next()) { // Iterate through the vehicle tracker table if the "if statements" are true for each vehicle tracker status change the status on the loaner vehicle catalog table as stated in the story

        if (vehStat == 'Pending Release' || vehStat == 'Out on Field' || vehStat == 'Returned for Inspection' || vehStat == 'Sent for Servicing') {
            gr.status = 'unavailable'; //If the vehicle status on the tracker table is pending release, out on field, returned for inspection, or sent for servicing

        } else if (vehStat == 'Returned to Warehouse') {
            gr.status = 'available'; // If the vehicle status on the tracker table is returned to warehouse then set the status field on the loaner vehicle catalog 

        } else if (vehStat == 'Decommissioned') {
            gr.status = 'Decommissioned'; //If the vehicle status on the tracker table is decommissioned then set the status field on the loaner vehicle catalog table to decommissioned
        }
        gr.update();
    }

})(current, previous);]]></script>
        <sys_class_name>sys_script</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-06-02 20:08:31</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>7a6a6b2583ea42103017c030ceaad31e</sys_id>
        <sys_mod_count>11</sys_mod_count>
        <sys_name>Vehicle Status-Auto Update to Available</sys_name>
        <sys_overrides/>
        <sys_package display_value="Loaner Vehicle Request and Inventory" source="x_1143021_loaner_v">fd212484838242103017c030ceaad3b8</sys_package>
        <sys_policy/>
        <sys_scope display_value="Loaner Vehicle Request and Inventory">fd212484838242103017c030ceaad3b8</sys_scope>
        <sys_update_name>sys_script_7a6a6b2583ea42103017c030ceaad31e</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-06-04 00:47:43</sys_updated_on>
        <template/>
        <when>after</when>
    </sys_script>
    <sys_translated_text action="delete_multiple" query="documentkey=7a6a6b2583ea42103017c030ceaad31e"/>
</record_update>
